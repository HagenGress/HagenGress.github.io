{% assign media_paths = include.images | split: ", " %}
{% assign gallery_width = include.width | default: "300" %}
{% assign page_url_without_index = page.url | remove: 'index' | remove: '.html' %}

<style>
  .media-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 2rem;
    margin-bottom: 2rem;
  }
  .media-item {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }
  .media-caption {
    margin-bottom: 0.5rem;
    font-weight: bold;
    text-align: left;
  }
</style>

<div class="media-grid">
  {% for media_entry in media_paths %}
    {% assign entry = media_entry | split: "::" %}
    {% assign media_name = entry[0] | strip %}
    {% assign caption = entry[1] | default: "" | strip %}
    {% assign extension = media_name | split: '.' | last | downcase %}

    {% if media_name contains 'https://' %}
      {% assign full_path = media_name %}
    {% else %}
      {% assign full_path = page_url_without_index | append: media_name %}
    {% endif %}

    <div class="media-item">
      <div class="media-caption" style="font-weight: normal;">{{ forloop.index }}. {{ caption }}</div>
      {% if extension == "mp4" %}
        <video 
          src="{{ full_path }}" 
          controls 
          muted 
          playsinline 
          style="width: {{ gallery_width }}px;"
        ></video>
      {% else %}
        <img 
          src="{{ full_path }}" 
          alt="{{ caption }}" 
          loading="lazy" 
          style="width: {{ gallery_width }}px;"
          onerror="this.onerror=null;this.src=this.src.replace('.webp','.png').replace('.png','.webp');"
        />
      {% endif %}
    </div>
  {% endfor %}
</div>
